/*

===================================================================== 
CREATE A DATABASE  AND SCHEMAS
========================================================================
SCRIPTS PURPOSE;
    THIS SCRIPTS  CREATE A NEW DATABASE NAMED DATAWAREHOUSE AFTER CHECKING IF IT ALREADY EXISTS.
    IT THE DATABASE ALREADY EXISTS,IT IS DROPED AND RECREATED .ADDITIONALLY ,THE SCRIPTS SETS UP THREE SCHEMAS
    WITHIN THE DATABSE : 'bronze ,'silver','gold'

WARNING:
   RUNNING THIS SCRIPTS  WILL DROP THE ENTIRE "DATAWAREHOUSE" DATABASE IF IT EXOSTS.
  ALL DATA IN THE DATABASE WILL BE PERMANENTLY DELETED.PROCEED WITH CAUTION
 AND ENSURE YOU HAVE PROPER BACKUPS BEFORE RUNNING THIS SCRIPTS.
*/

USE MASTER;
  GO


---DROP AND RECREATE THE 'DATAWAREHOUSE' DATABASE
IF EXISTS(SELECT 1 FROM SYS.DATABASES WHERE NAME='DATAWAREHOUSE')
 BEGIN
     ALTER DATABASE DATAWAREHOUSE SET SINGLE USER WITH ROLLBACK IMMEDIATE;
  DROP DATABSE DATAWAREHOUSE;
END;
GO
---create  databse 'DataWarehouse'----


create database DataWarehouse;

use DataWarehouse;

CREATE SCHEMA bronze;
go
CREATE SCHEMA Silver;
go

CREATE SCHEMA Gold;
GO
